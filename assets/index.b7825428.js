const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}};B();const L={initial:["QUE BIEN ESTE VIAJE POR LA REGI\xD3N DE LA MACARONESIA","SON UNAS ISLAS MUY BONITAS Y AHORA CON EL CAMBIO CLIM\xC1TICO SE HAN ESPECIALIZADO EN DIVERSAS \xC1REAS","LA PRIMERA PARADA PARECE QUE ES AZORES","VAMOS A ACERCARNOS"],azores_1:["LAS ISLAS DE AZORES, AQU\xCD EN LA GU\xCDA DICE QUE SE HAN CENTRADO EN LA GANADERIA ECOL\xD3GICA","ES UN GRAN PARAISO PARA LAS VACAS","PARECE QUE TIENEN UN RETO CON ESTE TEMA","A VER SI ERES CAPAZ DE SOLUCIONARLO, \xA1\xC1NIMO!"],azores_2:["SABIA QUE PODIAS!","TAMPOCO ES TAN DIFICIL, AUNQUE TODAVIA NO HE TERMINADO....","ESPERA A QUE ACABE",`(20 mins despues) 
 POR FIN, BUENO AHORA TOCA IR A MADEIRA`]},m={azoresCoor:[2447,1575,1034,856],madeiraCoor:[4085,1684,3300,1185],canariasCoor:[3032,2004,4572,2954],caboVerdeCoor:[900,2553,2423,3539]},h={INITIAL:"/assets/map/macaronesia.png",AZORES:"/assets/map/azores.png",MADEIRA:"/assets/map/azores.png",CANARIAS:"/assets/map/azores.png",CABOVERDE:"/assets/map/azores.png"},E={AZORES:{TITLE:"AZORES",NAME:"CONSTRUYE UN UNA AZOTEA ECOL\xD3GICA",DESCRIPTION:"ACABAS DE LLEGAR A AZORES, PERO PARECE QUE EN MAL TIEMPO, HA HABIDO UNA INUNDACI\xD3N. AYUDA A CONSTRUIR UN ESPACIO ECOL\xD3GICO PARA LOS HABITANTES DE AZORES"},MADEIRA:{TITLE:"MADEIRA",NAME:"ENCUENTRA LAS CAUSAS Y EFECTOS",DESCRIPTION:"SE HAN MEZCLADO LOS ESTUDIOS, AYUDA A CLASIFICARLOS"},CANARIAS:{TITLE:"CANARIAS",NAME:"RESUELVE EL PUZLE",DESCRIPTION:"HA HABIDO UNA PEQUE\xD1A INTOXICACI\xD3N EN LA COMIDA, TE HAS SALVADO POR POCO, PERO TE HAN PEDIDO QUE HAGAS UN CARTEL SOBRE LA CIG\xDCATERA, AYUDALES"},CABOVERDE:{TITLE:"CABO VERDE",NAME:"DEMUESTRA TU CONOCIMIENTO",DESCRIPTION:"ESTE ES EL \xDALTIMO RETO, ACIERTA TODAS LAS PREGUNTAS PARA ENSE\xD1AR LO QUE SABES DEL CAMBIO CLIM\xC1TICO"}};class v{constructor(e){e=="initial"?this.dialogs=L.initial:e=="azores_1"?this.dialogs=L.azores_1:e=="azores_2"?this.dialogs=L.azores_2:this.dialogs=["ERROR"],this.index=0}render(){let e=document.querySelector("#dialog-background");e.style.display="flex",document.querySelector("#container").classList.add("stop-scrolling");let i=document.querySelector("#dialog-msg"),r=document.createTextNode(this.dialogs[this.index]);i.appendChild(r)}update(){if(this.index++,this.index>=this.dialogs.length){this.end();return}else{let e=document.querySelector("#dialog-msg");console.log(e.firstChild),e.firstChild!=null&&(e.removeChild(e.firstChild),console.log(this.index),this.render());return}}end(){this.index=0,document.querySelector("#container").classList.remove("stop-scrolling");let t=document.querySelector("#dialog-background");t.style.display="none";let i=document.querySelector("#dialog-msg");i.firstChild!=null&&i.removeChild(i.firstChild)}}class f{constructor(e){this.img=e}start(){}end(){}addAreas(){}}class P{constructor(){this.imgs_questions=[{img:"berrenda",questions:["Tengo la piel llena de manchas rojas","Vivo en casi toda la pen\xEDnsula"]},{img:"guadarrama",questions:["Soy de Madrid","Tengo el pelo negro y largo"]},{img:"latxa",questions:["Soy de Vizcaya","Soy blanco"]},{img:"pirenaica",questions:["Vivo por el norte","Soy marron claro"]},{img:"payoya",questions:["Soy del sur","Soy blanco con manchas negras y coloradas"]}]}getOnlyQuestions(){let e=this.imgs_questions.map(t=>t.questions);return e=e.flatMap(t=>t),e}}class k{constructor(e,t){this.imgSrc=e,this.html=document.createElement("div"),this.html.classList.add("card");let i=document.createElement("img");i.src=`/assets/cards/${this.imgSrc}.PNG`,this.html.appendChild(i)}getImgSrc(){return this.imgSrc}render(e){e.appendChild(this.html)}}class S{constructor(e){this.container=document.querySelector("#gameboard"),this.container.innerHTML="",this.TITLE=e.TITLE,this.NAME=e.NAME,this.DESCRIPTION=e.DESCRIPTION}render(e){}addCloseButton(e){let t=document.createElement("button");t.innerHTML="X",t.id="close",t.addEventListener("click",()=>{e()}),this.container.appendChild(t)}start(e){this.addCloseButton(()=>{let s=document.querySelector("#gameboard-container");s.style.display="none",this.container.innerHTML=""});let t=document.createElement("h1");t.innerHTML=this.TITLE,t.id="title";let i=document.createElement("h2");i.innerHTML=this.NAME,i.id="description";let r=document.createElement("div");r.innerHTML=this.DESCRIPTION,r.id="descriptionText";let n=document.createElement("button");n.innerHTML="Jugar",n.id="start",this.container.appendChild(t),this.container.appendChild(i),this.container.appendChild(r),this.container.appendChild(n),n.addEventListener("click",()=>{this.container.innerHTML="",this.render(e)})}}class z extends S{constructor(){super(E.AZORES)}render(e){let t=new P,{imgs_questions:i}=t,r=document.createElement("h1"),n=Math.random()*t.imgs_questions.length;n=Math.floor(n);let s=t.getOnlyQuestions()[n],a=document.createTextNode(s);r.appendChild(a),this.container.appendChild(r);let o=document.createElement("div");o.id="gameboard-img-container";for(let d=0;d<i.length;d++){const y=i[d];let g=new k(y.img,t.imgs_questions);g.render(o),g.html.addEventListener("click",()=>{let c=i.findIndex(p=>p.img==g.imgSrc);console.log(i);let u=document.querySelector("h1");if(i[c].questions.includes(u.childNodes[0].nodeValue)){if(g.html.style.display="none",i.splice(c,1),i.length===0){let q=document.createTextNode("Has ganado!!");u.replaceChild(q,u.childNodes[0]),g.html.style.display="none",this.addCloseButton(()=>{let D=document.querySelector("#gameboard-container");D.style.display="none",this.container.innerHTML="",e.end()});return}let p=document.querySelector("#gameboard"),I=Math.floor(Math.random()*i.length);console.log(i),console.log(I);let x=i[I].questions[Math.round(Math.random())],R=document.createTextNode(x);u.replaceChild(R,u.childNodes[0]),p.insertBefore(u,p.firstChild)}})}this.container.appendChild(o)}}class C extends f{constructor(e,t){super(e);this.handler=()=>{},this.gameInit=!1,this.cleared=!1,this.startDialog=new v(`${t}_1`),this.endDialog=new v(`${t}_2`)}start(){let e=document.querySelector("#img-map");if(e.src=this.img,!this.gameInit){this.gameInit=!0,this.startDialog.render(),document.querySelector("#continue").addEventListener("click",()=>{this.startDialog.update()},!1);let i=document.querySelector("#dialog-background");i.style.display="flex"}e.addEventListener("click",this.handler,!1)}end(){if(!this.cleared){let e=document.querySelector("#dialog-background");e.style.display="flex",this.endDialog.render(),document.querySelector("#continue").addEventListener("click",()=>{this.endDialog.update()},!1),this.cleared=!0}}removeListener(){document.querySelector("#img-map").removeEventListener("click",this.handler,!1)}}class N extends C{constructor(){super(h.AZORES,"azores");this.handler=()=>{this.gameInit=!0;let e=new z,t=document.querySelector("#gameboard-container");t.style.display="flex",e.start(this)}}}class A{constructor(e,t,i){this.linkedValue="",this.value=e,this.bestMatch=t,this.clicked=!1,this.col=i}link(e){this.linkedValue=e}test(){return console.log(this.bestMatch==this.linkedValue),this.bestMatch==this.linkedValue}createImage(e){let t=e*90+10;var i=document.createElementNS("http://www.w3.org/2000/svg","image");return i.setAttributeNS("http://www.w3.org/1999/xlink","href",`/assets/emojis/${this.value}.png`),i.style.width="50px",i.style.marginLeft="30%",i.setAttribute("y",`${t}px`),i.addEventListener("mousedown",r=>{r.preventDefault(),this.clicked?r.target.classList.remove("emoji-clicked"):r.target.classList.add("emoji-clicked"),this.clicked=!this.clicked}),i}}class _{constructor(){this.column1=[new A("fire","forest",1),new A("water","ocean",1)],this.column2=[new A("ocean","water",2),new A("forest","fire",2)]}test(){let e=!0;return this.column1.forEach(t=>{t.test()||(e=!1)}),this.column2.forEach(t=>{t.test()||(e=!1)}),e}}class w{constructor(){this.x1=0,this.y1=0,this.x2=0,this.y2=0}createLine(){let e=document.createElementNS("http://www.w3.org/2000/svg","line");return e.setAttribute("x1",this.x1.toString()),e.setAttribute("y1",this.y1.toString()),e.setAttribute("x2",this.x2.toString()),e.setAttribute("y2",this.y2.toString()),e.style.width="5px",e.style.stroke="red",e}}class U extends S{constructor(){super(E.MADEIRA);this.index=0,this.line=document.createElementNS("http://www.w3.org/2000/svg","line"),this.pairList=[],this.target=null,this.lineObj=new w}render(e){let t=new _,i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.id="emojiContainer";let r=document.createElementNS("http://www.w3.org/2000/svg","g");r.id="col-1",t.column1.forEach((n,s)=>{let a=n.createImage(s);a.classList.add("col-1"),a.addEventListener("mousedown",o=>{this.addLine(o,n)}),r.appendChild(a)}),i.appendChild(r),r=document.createElementNS("http://www.w3.org/2000/svg","g"),r.id="col-2",t.column2.forEach((n,s)=>{let a=n.createImage(s);a.setAttribute("x","100px"),a.classList.add("col-2"),a.addEventListener("mousedown",o=>{this.addLine(o,n)}),r.appendChild(a)}),i.appendChild(r),i.addEventListener("mouseup",()=>{t.test()&&e.end()}),this.container.appendChild(i)}addLine(e,t){var i;let r=e.target;if(this.target==null){let n=r.getBBox(),s=n.x+n.width*.5,a=n.y+n.height*.5;this.lineObj.x1=s,this.lineObj.y1=a,this.target=t;return}else if(this.target!=null){if(this.target.col==t.col){this.lineObj.x1=0,this.lineObj.y1=0,this.target=null,e.target;return}let n=r.getBBox(),s=n.x+n.width*.5,a=n.y+n.height*.5;this.lineObj.x2=s,this.lineObj.y2=a;let o=this.lineObj.createLine();this.lineObj=new w,this.target.link(t.value),t.link(this.target.value),this.target=null,(i=this.container.firstChild)===null||i===void 0||i.appendChild(o)}}}class O extends C{constructor(){super(h.MADEIRA,"madeira");this.handler=()=>{this.gameInit=!0;let e=new U,t=document.querySelector("#gameboard-container");t.style.display="flex",e.start(this)}}}class H{constructor(e){this.img=e,this.currentX=0,this.currentY=0,this.currentPosX=0,this.currentPosY=0}selectedElement(e){let t=this.short(e);this.currentX=e.clientX,this.currentY=e.clientY,this.currentPosX=parseFloat(t.getAttribute("x")),this.currentPosY=parseFloat(t.getAttribute("y")),t.onmousemove=i=>this.movement(i)}movement(e){let t=e.target,i=e.clientX-this.currentX,r=e.clientY-this.currentY;this.currentPosX=this.currentPosX+i,this.currentPosY=this.currentPosY+r,t.setAttribute("x",this.currentPosX.toString()),t.setAttribute("y",this.currentPosY.toString()),this.currentX=e.clientX,this.currentY=e.clientY,this.iman(t)}deselectedElement(e){let t=e.target;t.onmousemove=i=>{}}short(e){var t;let i=e.target.parentNode;var r=i.id;let n=document.querySelector("#puzleContainer");return n.removeChild(document.getElementById(r)),n.appendChild(i),(t=n.lastChild)===null||t===void 0?void 0:t.firstChild}iman(e){var t=[300,414,528,300,414,528,300,414,528,300,414,528],i=[20,20,20,84,84,84,148,148,148,212,212,212];for(let r=0;r<12;r++)Math.abs(this.currentPosX-t[r])<30&&Math.abs(this.currentPosY-i[r])<30&&(e.setAttribute("x",t[r].toString()),e.setAttribute("y",i[r].toString()))}}class V{constructor(){this.image_complete="puzle.png",this.rows=4,this.columns=3,this.image_parts=[];for(let e=1;e<=this.rows;e++)for(let t=1;t<=this.columns;t++){let i=new H(`row-${e}-column-${t}.png`);this.image_parts.push(i)}}testing(){let e=0,t=document.querySelectorAll(".piece-puzle");var i=[300,414,528,300,414,528,300,414,528,300,414,528],r=[20,20,20,84,84,84,148,148,148,212,212,212];for(let n=0;n<this.rows*this.columns;n++){let s=t[n],a=parseInt(s.firstChild.getAttribute("x")),o=parseInt(s.firstChild.getAttribute("y")),d=parseInt(s.id);i[d]==a&&r[d]==o&&e++}return e}}class G extends S{constructor(){super(E.CANARIAS);this.index=0}render(e){let t=new V,i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.id="puzleContainer",i.setAttributeNS(null,"width","600px"),i.setAttributeNS(null,"height","600px");var r=document.createElementNS("http://www.w3.org/2000/svg","g");r.id="guide-puzle";var n=document.createElementNS("http://www.w3.org/2000/svg","image");n.setAttributeNS("http://www.w3.org/1999/xlink","href",`/assets/puzzle/${t.image_complete}`),n.setAttribute("width","342px"),n.setAttribute("height","256px"),n.setAttribute("x","300"),n.setAttribute("y","20"),n.style.border="1px solid red",r.appendChild(n),i.appendChild(r),i.addEventListener("mouseup",()=>{if(t.testing()>=16){this.container.innerHTML="";let a=document.createTextNode("Has ganado!!");this.container.appendChild(a),this.addCloseButton(()=>{let o=document.querySelector("#gameboard-container");o.style.display="none",this.container.innerHTML="",e.end()})}}),t.image_parts.forEach((s,a)=>{var o=document.createElementNS("http://www.w3.org/2000/svg","g");o.id=a.toString(),o.classList.add("piece-puzle");var d=document.createElementNS("http://www.w3.org/2000/svg","image");d.setAttributeNS("http://www.w3.org/1999/xlink","href",`/assets/puzzle/${s.img}`),d.setAttribute("width","114px"),d.setAttribute("height","64px");let y=Math.floor(Math.random()*10)+1,g=Math.floor(Math.random()*200)+1;d.setAttribute("x",y.toString()),d.setAttribute("y",g.toString()),d.addEventListener("mousedown",c=>{s.selectedElement(c)}),d.addEventListener("mouseout",c=>{s.deselectedElement(c)}),d.addEventListener("mouseleave",c=>{s.deselectedElement(c)}),d.addEventListener("mouseup",c=>{s.deselectedElement(c);let u=t.testing();console.log(u),u>=12&&(console.log("ganaste"),e.end())}),o.appendChild(d),i.appendChild(o)}),this.container.appendChild(i)}selectedItem(e){let t=e.target;console.log(t);let i=e.clientX,r=e.clientY,n=parseFloat(t.getAttribute("x")||""),s=parseFloat(t.getAttribute("y")||"");t.addEventListener("mousemove",a=>this.movement(t,a,i,r,n,s))}movement(e,t,i,r,n,s){var a=t.clientX-i,o=t.clientY-r;console.log(n),e.setAttribute("x",(n+a).toString()),e.setAttribute("y",(s+o).toString()),e.addEventListener("mouseout",d=>this.deselectedItem(e)),e.addEventListener("mouseup",d=>this.deselectedItem(e))}deselectedItem(e){e.removeEventListener("mousemove",t=>{this.movement}),e.removeEventListener("mouseout",()=>{this.deselectedItem}),e.removeEventListener("mouseup",()=>{this.deselectedItem})}}class T extends C{constructor(){super(h.CANARIAS,"canarias");this.handler=()=>{this.gameInit=!0;let e=new G,t=document.querySelector("#gameboard-container");t.style.display="flex",e.start(this)}}}class Y{constructor(){this.imgs_questions=[{img:"reserva_natural_garajau.jpg",answers:["reserva natural garajau","sitio_2","sitio_3","sitio_4"],correct:"reserva natural garajau"}]}getOnlyQuestions(){let e=this.imgs_questions.map(t=>t.questions);return e=e.flatMap(t=>t),e}}class j extends S{constructor(){super(E.CABOVERDE);this.index=0}render(e){let t=new Y,{imgs_questions:i}=t,r=document.createElement("img");r.id="cabo_verde_image_level",r.src=`/assets/places/${i[this.index].img}`,this.container.appendChild(r);for(let n=0;n<i[this.index].answers.length;n++){let s=document.createElement("div"),a=i[this.index].answers[n];s.innerHTML=a,s.addEventListener("click",()=>{if(a==i[this.index].correct)if(this.index++,console.log(this.index),console.log(i.length),this.index>=i.length){this.container.innerHTML="";let o=document.createTextNode("Has ganado!!");this.container.appendChild(o),this.addCloseButton(()=>{let d=document.querySelector("#gameboard-container");d.style.display="none",this.container.innerHTML="",e.end()});return}else this.render(e)}),this.container.appendChild(s)}}}class M extends C{constructor(){super(h.CABOVERDE,"caboVerde");this.handler=()=>{this.gameInit=!0;let e=new j,t=document.querySelector("#gameboard-container");t.style.display="flex",e.start(this)}}}class X extends f{constructor(){super(h.INITIAL);this.areas=document.querySelector("map"),this.azoresArea=document.querySelector("#azores"),this.madeiraArea=document.querySelector("#madeira"),this.canariasArea=document.querySelector("#canarias"),this.caboVerdeArea=document.querySelector("#cabo-verde"),this.dialog=new v("initial");let e=document.querySelector("#img-map");e.src=super.img,window.addEventListener("resize",t=>{t.preventDefault();let i={height:e.clientHeight/3867,width:e.clientWidth/6900};this.azoresArea.coords=this.resize(m.azoresCoor,i).join(", "),this.madeiraArea.coords=this.resize(m.madeiraCoor,i).join(", "),this.canariasArea.coords=this.resize(m.canariasCoor,i).join(", "),this.caboVerdeArea.coords=this.resize(m.caboVerdeCoor,i).join(", ")})}start(){let e=document.querySelector("#img-map");e.src=super.img;let t=document.querySelector("#dialog-background");t.style.display="flex",this.dialog.render(),document.querySelector("#continue").addEventListener("click",()=>{this.dialog.update()},!1)}resize(e,t){return[Math.floor(e[0]*t.width),Math.floor(e[1]*t.height),Math.floor(e[2]*t.width),Math.floor(e[3]*t.height)]}addAreas(){let e=document.querySelector("#img-map");e.src=this.img;let t={height:e.clientHeight/3867,width:e.clientWidth/6900};this.azoresArea.coords=this.resize(m.azoresCoor,t).join(", "),this.azoresArea.addEventListener("click",()=>{var i;document.querySelector("#continue").removeEventListener("click",()=>{this.dialog.update()},!1);let n=new N;if(n.start(),document.querySelectorAll("span").length==0){let s=document.querySelector("map");s.style.display="none";let a=document.createElement("span");a.classList.add("btn"),a.innerHTML='<img src="/assets/map/map_icon.png">',a.id="goToBack",(i=document.querySelector("#container"))===null||i===void 0||i.appendChild(a),a.addEventListener("click",()=>{var o;n.removeListener(),e.src=h.INITIAL,(o=document.querySelector("#container"))===null||o===void 0||o.removeChild(a)})}}),this.madeiraArea.coords=this.resize(m.madeiraCoor,t).join(", "),this.madeiraArea.addEventListener("click",()=>{var i;let r=new O;if(r.start(),document.querySelectorAll("span").length==0){let n=document.createElement("span");n.classList.add("btn"),n.innerHTML='<img src="/assets/map/map_icon.png">',n.id="goToBack",(i=document.querySelector("#container"))===null||i===void 0||i.appendChild(n),n.addEventListener("click",()=>{var s;r.removeListener(),e.src=h.INITIAL,(s=document.querySelector("#container"))===null||s===void 0||s.removeChild(n)})}}),this.canariasArea.coords=this.resize(m.canariasCoor,t).join(", "),this.canariasArea.addEventListener("click",()=>{var i;let r=new T;if(r.start(),document.querySelectorAll("span").length==0){let n=document.createElement("span");n.classList.add("btn"),n.innerHTML='<img src="/assets/map/map_icon.png">',n.id="goToBack",(i=document.querySelector("#container"))===null||i===void 0||i.appendChild(n),n.addEventListener("click",()=>{var s;r.removeListener(),e.src=h.INITIAL,(s=document.querySelector("#container"))===null||s===void 0||s.removeChild(n)})}}),this.caboVerdeArea.coords=this.resize(m.caboVerdeCoor,t).join(", "),this.caboVerdeArea.addEventListener("click",()=>{var i;let r=new M;if(r.start(),document.querySelectorAll("span").length==0){let n=document.createElement("span");n.classList.add("btn"),n.innerHTML='<img src="/assets/map/map_icon.png">',n.id="goToBack",(i=document.querySelector("#container"))===null||i===void 0||i.appendChild(n),n.addEventListener("click",()=>{var s;r.removeListener(),e.src=h.INITIAL,(s=document.querySelector("#container"))===null||s===void 0||s.removeChild(n)})}})}}class Q{constructor(){this.settings={effects:50,music:50,name:""},this.initialMap=new X,this.azoresMap=new N,this.caboVerdeMap=new M,this.canariasMap=new T,this.madeiraMap=new O,this.currentMap=this.initialMap}updateSettings(e){this.settings=e}start(){this.currentMap.start()}addAreas(){this.currentMap.addAreas()}}let b=new Q;b.start();window.addEventListener("load",()=>{b.addAreas()});
